<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title></title>
  <link rel="stylesheet" type="text/css" href="assets/css/home.css">
  <link rel="stylesheet" type="text/css" href="assets/css/mystyle.css">
  
  
  <!-- for mathjax support -->
  
  <script>
    window.MathJax = {
      tex: {
        tags: "ams",
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        autoload: {
          color: [],
          colorv2: ['color']
        },
        packages: {'[+]': ['noerrors']}
      },
      options: {
        ignoreHtmlClass: 'tex2jax_ignore',
        processHtmlClass: 'tex2jax_process'
      },
      loader: {
        load: ['[tex]/noerrors']
      }
    };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script"></script>
  
  
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jsxgraph/1.1.0/jsxgraphcore.js"></script>
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/jsxgraph/1.1.0/jsxgraph.css" />
  
  <script src="assets/js/coding.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <!--<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script>-->
  <script src="assets/js/course.js"></script>
  <script src="assets/js/prob.js"></script>
</head>
<body>
  <!-- Top navigation bar from the main webpage. must be updated from page.html-->
  <div class="topnav">
  <a style="float:left;" href="../index.html"><strong>Farzad Farnoud</strong></a>
  <a id="teaching" href="../teaching.html">Teaching</a>
  <a id="pubs" href="../publications.html">Publications</a>
  <a id="home" href="../index.html">Home</a> 
  <script>document.getElementById('teaching').className = "active";</script>
  </div>
  <nav>
   <div class="sidenav">
     <!--<a href="/">Home</a><br>
	     <a href="/moi/">Course Index</a><hr>-->
	   <!--<h3><div class="chapnav"> Mathematics of <br> Information</div></h3>-->
     
     
     
    
     
      
        <a href="/moi/"><strong>Mathematics of Information</strong></a>
      
     
     
    
     
     
      <span class="chapnav"><strong>1. Numbers, fields, and <br>representing information</strong></span>
      <ul>
      
        
          
            <li><a href="/moi/sets.html">Sets and set theory</a></li>
          
        
      
        
          
            <li><a href="/moi/numbers.html">Natural numbers, rationals</a></li>
          
        
      
        
          
            <li><a href="/moi/fields.html">Fields</a></li>
          
        
      
        
          
            <li><a href="/moi/reals.html">Real numbers</a></li>
          
        
      
        
          
            <li><a href="/moi/counting.html">Counting and cardinality</a></li>
          
        
      
        
          
            <li><a href="/moi/representation.html">Representing information</a></li>
          
        
      
    </ul>
    
    
     
     
      <span class="chapnav"><strong>2. Probability &amp; information</strong></span>
      <ul>
      
        
          
            <li><a href="/moi/defining_information.html">Defining information</a></li>
          
        
      
        
          
            <li><a href="/moi/probability_basics.html">Basics of probability</a></li>
          
        
      
        
          
            <li><a href="/moi/distributions.html">Random variables, <br> distributions, independence</a></li>
          
        
      
        
          
            <li><a href="/moi/expectation.html">Expectation and Variance</a></li>
          
        
      
        
          
            <li><a href="/moi/conditional.html">Conditional probability</a></li>
          
        
      
        
          
            <li><a href="/moi/markov.html">Random sequences and <br> Markov chains</a></li>
          
        
      
        
          
            <li><a href="/moi/information_theory.html">Quantifying Information</a></li>
          
        
      
        
          
            <li><a href="/moi/compression.html">Data compression</a></li>
          
        
      
        
          
            <li><a href="/moi/communications.html">Mathematics of communications</a></li>
          
        
      
    </ul>
    
    
     
     
      <span class="chapnav"><strong>3. Linear algebra, finite fields, <br>and error correction</strong></span>
      <ul>
      
        
          
            <li><a href="/moi/codes_graphs_algebra.html">Codes, graphs, and algebra</a></li>
          
        
      
        
          
            <li><a href="/moi/vectors.html">Vectors and spaces</a></li>
          
        
      
        
          
            <li><a href="/moi/fundamental_spaces.html">Fundamental spaces</a></li>
          
        
      
        
          
            <li><a href="/moi/ecc.html">Linear codes</a></li>
          
        
      
    </ul>
    
    
     
     
      <span class="chapnav"><strong>4. The frequency domain and <br>transmission of information</strong></span>
      <ul>
      
        
          
            <li><a href="/moi/complex.html">Complex numbers</a></li>
          
        
      
        
          
            <li><a class="active" style="color:#76bdd59c" href="/moi/fourier.html"><img class="emoji" title=":point_right:" alt=":point_right:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f449.png" height="20" width="20"> Frequency and spectrum</a></li>
          
        
      
        
          
            <li><a href="/moi/sampling.html">Filteration and sampling</a></li>
          
        
      
        
          
            <li><a href="/moi/linsys.html">Linear systems</a></li>
          
        
      
        
          
            <li><a href="/moi/freqresponse.html">Frequency response</a></li>
          
        
      
        
          
            <li><a href="/moi/modulation.html">Modulation</a></li>
          
        
      
        
          <li class="chapnav">Orthogonality</li>
        
      
        
          <li class="chapnav">Multiple-access communication</li>
        
      
    </ul>
    
    
     
     
      <span class="chapnav"><strong>5. Number theory and <br>information privacy</strong></span>
      <ul>
      
        
          <li class="chapnav">Encryption</li>
        
      
        
          <li class="chapnav">Number theory</li>
        
      
        
          <li class="chapnav">Public key cryptography</li>
        
      
    </ul>
    
    
     
     
      <span class="chapnav"><strong>6. Boolean algebra and <br>computation</strong></span>
      <ul>
      
        
          <li class="chapnav">Number systems and arithmetic</li>
        
      
        
          <li class="chapnav">Boolean algebra</li>
        
      
        
          <li class="chapnav">Logic design and computation</li>
        
      
        
          <li class="chapnav">
        
      
    </ul>
    
    
     
     
      <span class="chapnav"><strong>Appendix</strong></span>
      <ul>
      
        
          
            <li><a href="/moi/axiomatic.html">Axiomatic systems</a></li>
          
        
      
        
          
            <li><a href="/moi/index.html"><br></a></li>
          
        
      
        
          
            <li><a href="/moi/index.html"><br></a></li>
          
        
      
    </ul>
    
    
  </div>
</nav>
<div class="main">
  <!-- variables for replacement -->
  <h1 id="frequency-and-spectrum">Frequency and Spectrum</h1>

<!-- Frequency and periodicity

Light and frequency

Frequencies and harmonics in music

Complex numbers -->

<p><!-- Spectrum definition and the Fourier transform --></p>

<p><!-- Frequency vs. time: the spectrogram --></p>

<div style="float: right;">

<img src="https://imgs.xkcd.com/comics/fourier.jpg" width="350px">
<p>
Fortunately, Dr. Elizabeth was able to invert the transform. <br>
Image credit: Randall Munroe/<a href="http://xkcd.com">xkcd.com</a>
</p>
</div>

<p>A signal is a function of time $x(t)$ in audio, or a function of space
$I(x, y)$ in an image.</p>

<p>Another way to describe a signal is by the <em>frequency</em> content.</p>

<p>Let us start by imagining a single sinusoid (a cosine function or a sine function, for example):
$x(t) = A \cos(2 \pi f t + \phi)$</p>

<p>This sinusoid has three parameters: the amplitude <em>A</em>, the frequency
<em>f</em>, and the phase <em>φ</em>. The <em>period</em> is the smallest time <em>T</em> such that $x(t) = x(t + T)$ for all <em>t</em>. The following interactive graph may help you understand these concepts.</p>

<div id="sin" class="jxgbox" style="width:400px; height:400px;"></div>
<script>
JXG.Options.text.useMathJax = true;
var b_sin = JXG.JSXGraph.initBoard('sin', {boundingbox: [-0.3, 1.6, 4, -1], axis: true, showCopyright: false, showNavigation: false});
var slide_a = b_sin.create('slider',[[0.1, 1.5], [3.2, 1.5], [0.1, 0.5, 1.0]], {name: "A"});
var slide_f = b_sin.create('slider',[[0.1, 1.3], [3.2, 1.3], [1, 3, 10]], {name: "f", snapWidth: 1});
var slide_phi = b_sin.create('slider',[[0.1, 1.1], [3.2, 1.1], [0, 0, 6.28]], {name: "φ", snapWidth: Math.PI/6});
b_sin.create('functiongraph', [(x) => slide_a.Value() * Math.cos(2*Math.PI*slide_f.Value() * x + slide_phi.Value()), -10, 10]);
</script>

<!-- What is the period of this sinusoid? -->

<h2 id="what-is-frequency">What is frequency?</h2>

<p>In the sinusoid example, the frequency <em>f</em> is the inverse of the period
<em>T</em>. The faster the signal repeats, the higher its frequency.</p>

<p>So the <em>frequency</em> measures how fast a single <em>tone</em> repeats.</p>

<p>Yes, but it can be used in other contexts as well, even when the signal is not periodic…</p>

<h2 id="sound-waves-and-music">Sound waves and music</h2>
<p>Sound and music are good ways to better understand frequencies.
Music generally consists of chords that contain multiple notes simultaneously.</p>

<p><button onclick="play()">Play</button></p>
<div class="snd_func" id="sound_func1" style="display: block">$x(t) = \cos(2 \pi 440 t)$</div>
<div class="snd_func" id="sound_func2" style="display: none">$x(t) = \frac12 ( \cos (2 \pi 440 t) + \cos (2 \pi 554.4 t) )$</div>
<div class="snd_func" id="sound_func3" style="display: none">$x(t) = \frac13 ( \cos (2 \pi 440 t) + \cos (2 \pi 554.4 t) + \cos (2 \pi 659.3 t))$</div>
<div class="snd_func" id="sound_func4" style="display: none">$x(t) = \frac14 ( \cos (2 \pi 440 t) + \cos (2 \pi 554.4 t) + \cos (2 \pi 659.3 t) + \cos (2 \pi 880 t))$</div>
<div id="sound_harmo_plot" class="jxgbox" style="width:400px; height:400px;"></div>
<script>
JXG.Options.text.useMathJax = true;
var sound_harmo = JXG.JSXGraph.initBoard('sound_harmo_plot', {boundingbox: [-0.002, 1.3, 0.03, -1.1], axis: true, showCopyright: false, showNavigation: false});
var slider_n_harmo = sound_harmo.create('slider', [[0.001, 1.15], [0.025, 1.15], [1, 1, 4]], {name: "n", snapWidth: 1});
let sound_f = (x) => {
        let n = slider_n_harmo.Value();
        var f = 0;
        for (let i = 0; i < n; i++) {
            f += 1./n * Math.cos(2 * Math.PI * 440 * Math.pow(2, 1./3*i) * x);
        }
        return f;
}
slider_n_harmo.on('drag', () => {
    var func_doms = document.getElementsByClassName("snd_func");
    var show_dom = document.getElementById("sound_func" + slider_n_harmo.Value());
    for (e of func_doms) {
        if (e == show_dom) {
            e.style.display = "block";
        }
        else {
            e.style.display = "none";
        }
    }
})
var g = sound_harmo.create('functiongraph', [
    sound_f, 0, 10]);
function play() {
    var audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    var myArrayBuffer = audioCtx.createBuffer(2, audioCtx.sampleRate * 1, audioCtx.sampleRate);
    for (var channel = 0; channel < myArrayBuffer.numberOfChannels; channel++) {
        var nowBuffering = myArrayBuffer.getChannelData(channel);
        for (var i = 0; i < myArrayBuffer.length; i++) {
            let t = i / audioCtx.sampleRate;
            nowBuffering[i] = sound_f(t);
        }
    }
    var source = audioCtx.createBufferSource();
    source.buffer = myArrayBuffer;
    source.connect(audioCtx.destination);
    source.start();
}
</script>

<h4 id="what-are-the-units-of-frequency">What are the units of frequency?</h4>

<p>Generally speaking, frequency is measured in cycles/unit time.</p>

<p>When time <em>t</em> is in seconds, frequency <em>f</em> is in cycles/second, or
Hertz (Hz).</p>

<p>Music generally measures notes relative to “high A”, which has a frequency of 440 Hz.</p>

<h4 id="how-fast-is-440-hz">How fast is 440 Hz?</h4>

<p>We can also measure frequency in radians/unit time. This measure of frequency, $ω = 2πf$, is commonly encountered when describing the behavior of analog electronic circuits.</p>

<p>440 Hz = 2764.6 radians/second</p>

<p>We are used to describing many kinds of signals in terms of their frequency content.</p>

<p>Light (frequency = color)</p>

<p>Radio (frequency = station)</p>

<p>Music (frequency = note)</p>

<p>Video (frequency = frame rate)</p>

<p>Heart beat (frequency = heart rate)</p>

<p>Brain waves (frequency = alpha/beta/gamma/…)</p>

<h3 id="light-and-frequency">Light and frequency</h3>

<p>Visible light exists in many colors. These colors reflect the frequency, or equivalently the wavelength, of the light wave: wavelength (λ) = speed of light (<em>c</em>) / frequency (<em>ν</em>)</p>

<p>Violet light has the highest frequency (670-790 THz), and the shortest wavelength (380-450 nm).</p>

<p>Next comes blue light (600-670 THz), then green (520-600 THz), yellow
(510-520 THz), orange (480-510 THz), and finally red light (400-480
THz).</p>

<div style="float;"><img src=".//media/fourier/image1.png" width="250px"></div>

<p>The energy (E) of the corresponding light photon increases with increasing frequency: $E = h \nu = \frac{h c}{\lambda}$.  h = Planck’s constant ($6.6 \times 10^{-34} J\cdot s)$.</p>

<p>In fact, how we perceive visible light is due to its frequency:</p>

<p>The back of the eye (retina) contains two types of light-sensitive cells: rods and cones.</p>

<p><em>Rods</em> are sensitive to a wide range of light frequencies.</p>

<p><em>Cones</em> are sensitive to particular ranges of frequencies corresponding roughly to blue, green, and red.</p>

<p>The optic nerve transmits signals from these cells to the brain, which synthesizes them into colors.</p>

<h3 id="cameras-and-colors">Cameras and colors</h3>

<p>1855: The idea of three color-sensitive cone cells was posited by James
Clerk Maxwell (yes, <em>that</em> Maxwell) as a possible basis for color photography.</p>

<p>1868: Louis du Hauron patented the basic process for producing color photographs on paper. This idea is based on <em>subtractive color</em>, i.e., forming colors by removing components of white light (that contains all colors). This is also how color printers work, with cyan, magenta, and yellow ink instead of red, green, and blue.</p>

<p>1935: Eastman Kodak introduced color camera film (Kodachrome), with three layers of emulsion that recorded the red, green, and blue components of light. Agfa developed improved film a year later, that would allow developing all three colors simultaneously.</p>

<p>1963: Polaroid introduced color film for their instant camera.</p>

<p>Digital cameras work similarly:</p>

<p>Silicon-based sensors convert incident photons into energy, read out as voltages.</p>

<p>Filters placed on these sensors make them sensitive to specific ranges of light.</p>

<p>Cameras can arrange these sensors in an alternating mosaic like the Bayer pattern on the right. <em>Image demosaicking</em> takes the red, green, and blue images and aligns them to form a single RGB color image.</p>

<p>Some modern cameras can stack these sensors and filters to get red, green, and blue together.</p>

<p>Other electromagnetic radiation is also characterized by its frequency:</p>

<p>Ultraviolet (7.5×10^14 – 3×10^16 Hz)</p>

<p>Infrared (3×10^11 – 4.3×10^14 Hz)</p>

<p>X-rays (3×10^16 – 3×10^19 Hz)</p>

<p>Gamma rays (&gt; 3×10^19 Hz)</p>

<p>Microwaves (3×10^8 – 3×10^11 Hz)</p>

<p>Radio waves (30 – 3×10^8 Hz)</p>

<p>Energy increases as frequency increases – this is why ultraviolet radiation can cause skin cancer, and repeated, significant X-ray or gamma radiation exposure can be deadly.</p>

<p>Fortunately, extremely high energy radiation from the sun is mostly disrupted by the earth’s magnetic field and the ozone layer. Or we’d all be cooked like a rotisserie chicken!</p>

<h3 id="sound-waves-and-music-1">Sound waves and music</h3>

<p>Like light, sound propagates as a wave, and hence can be described as a sinusoid (or a collection of sinusoids).</p>

<p>Humans can hear sounds with frequencies between  20 – 20,000 Hz (this varies with age, and person-to-person)</p>

<p>Dogs can hear up to nearly 50,000 Hz!</p>

<p>Dolphins can hear up to 150,000 Hz!!!</p>

<p>Pure sinusoids are called tones. These have single frequencies.</p>

<p>High “A” = 440 Hz</p>

<p>Middle “C” = 262 Hz</p>

<p>Each octave corresponds to doubling in frequency.</p>

<p>Actual musical notes are more complicated. Music generally consists of chords that contain multiple notes simultaneously.</p>

<p>We can superimpose three tones to form a triad, or combine four :</p>

<p>Note the relationship between frequency and notes on the musical octave scale:</p>
<div style="float;"><img src=".//media/fourier/image2.png" width="450px"></div>
<div style="float;"><img src=".//media/fourier/image3.png" width="450px"></div>

<h2 id="the-spectrum">The spectrum</h2>

<p>What is the frequency content of the signals that we’ve seen so far? In other words, what are the frequencies present in the signal? This is called the spectrum.</p>

<p>Let’s see a few examples</p>

<div class="snd_func_w_spec" id="sound_w_spec_func1" style="display: block">$x(t) = \cos(2 \pi 440 t)$ - Signal consists of a single frequency</div>
<div class="snd_func_w_spec" id="sound_w_spec_func2" style="display: none">$x(t) = \frac12 ( \cos (2 \pi 440 t) + \cos (2 \pi 554.4 t) )$ - Combination (sum) of two frequencies</div>
<div class="snd_func_w_spec" id="sound_w_spec_func3" style="display: none">$x(t) = \frac13 ( \cos (2 \pi 440 t) + \cos (2 \pi 554.4 t) + \cos (2 \pi 659.3 t))$ - Combination (sum) of three frequencies</div>
<div class="snd_func_w_spec" id="sound_w_spec_func4" style="display: none">$x(t) = \frac14 ( \cos (2 \pi 440 t) + \cos (2 \pi 554.4 t) + \cos (2 \pi 659.3 t) + \cos (2 \pi 880 t))$ - Combination (sum) of four frequencies</div>
<div id="sound_harmo_plot_w_spec" class="jxgbox" style="width:400px; height:400px;"></div>
<div id="sound_harmo_plot_s_spec" class="jxgbox" style="width:400px; height:400px;"></div>

<script>
JXG.Options.text.useMathJax = true;
var sound_harmo_w_spec = JXG.JSXGraph.initBoard('sound_harmo_plot_w_spec', {title: "Signal", boundingbox: [-0.002, 1.3, 0.03, -1.1], axis: true, showCopyright: false, showNavigation: false});
var sound_harmo_plot_s_spec = JXG.JSXGraph.initBoard('sound_harmo_plot_s_spec', {title: "Spectrum", boundingbox: [-100, 1.1, 1000, -0.1], axis: true, showCopyright: false, showNavigation: false});
var slider_n_harmo_spec = sound_harmo_w_spec.create('slider', [[0.001, 1.15], [0.025, 1.15], [1, 1, 4]], {name: "n", snapWidth: 1});
var spec_lines = [];
spec_lines.push(sound_harmo_plot_s_spec.create('line', [[440, 0], [440, 1]], {straightFirst:false, straightLast:false, strokeWidth:2}))
let sound_f2 = (x) => {
        let n = slider_n_harmo_spec.Value();
        var f = 0;
        for (let i = 1; i <= n; i++) {
            f += 1./n * Math.cos(2 * Math.PI * 440 * Math.pow(2, 1./3*i) * x);
        }
        return f;
}
slider_n_harmo_spec.on('drag', () => {
    var func_doms = document.getElementsByClassName("snd_func_w_spec");
    var show_dom = document.getElementById("sound_w_spec_func" + slider_n_harmo_spec.Value());
    for (e of func_doms) {
        if (e == show_dom) {
            e.style.display = "block";
        }
        else {
            e.style.display = "none";
        }
    }
    let n = slider_n_harmo_spec.Value();
    var f = 0;
    spec_lines.forEach((e) => sound_harmo_plot_s_spec.removeObject(e))
    for (let i = 0; i < n; i++) {
        f = 440 * Math.pow(2, i/3);
        spec_lines.push(sound_harmo_plot_s_spec.create('line', [[f, 0], [f, 1./n]], {straightFirst:false, straightLast:false, strokeWidth:2}))
    }
})
var g = sound_harmo_w_spec.create('functiongraph', [sound_f2, 0, 10]);
</script>

<p>Pure tones or combinations of pure tones are fine, but they don’t sound very musical.</p>

<p>What are we missing? Harmonics!</p>

<p>Musical instruments don’t play pure tones. They play periodic signals that are shaped by the characteristic of the instrument.</p>

<p>These periodic signals not only have a frequency spike at the fundamental frequency; they also have spikes at multiples of that frequency. These multiples, or <em>overtones</em>, correspond to the $2nd - nth$ <em>harmonics</em> of the instrument.</p>

<p>Different instruments weight these harmonics relatively differently to produce different sound.</p>

<p>Piano</p>
<div style="float;"><img src=".//media/fourier/image10.png" width="650px"></div>

<p>Trumpet</p>
<div style="float;"><img src=".//media/fourier/image11.png" width="650px"></div>

<p>We see the same periodicity (high “A”) in the waveforms, but the character is different:</p>

<div style="float;"><img src=".//media/fourier/image13.png" width="650px"></div>

<p>There’s a lot more that goes into the shape of a musical waveform and its impact on the corresponding sound. We won’t go into it in this class…</p>

<p>The “envelope” of the waveform: attack, sustain, and release</p>

<p>The timbre of the instrument: the texture created by the envelope and harmonic weightings</p>

<p>The underlying oscillation (cosine or some other waveform)</p>

<p>Loudness or volume</p>

<p>Tempo</p>

<h2 id="fourier-series">Fourier series</h2>

<p>Now that we have a general understanding of what frequency is, let’s see what’s actually going on.</p>

<p>We can write any periodic signal as a sum of sines and cosines!</p>

<p>$x\left( t \right) = a_{0} + \sum_{k = 1}^{\infty}\left( a_{k}\cos\left( \frac{2\pi kt}{T} \right) + b_{k}\sin\left( \frac{2\pi kt}{T} \right) \right)$</p>

<p>$a_{k}$ and $b_{k}$ tell us how much of each frequency is present</p>

<p>It turns out that it’s easier and more powerful to work with complex exponentials rather than sines and cosines. This is called the
<strong>complex Fourier series:</strong></p>

<p>$x\left( t \right) = \sum_{k = - \infty}^{\infty}{a_{k}e^{i2\pi kt/T}}$</p>

<p>Let’s take a closer look at For example,</p>

<p>$\color{green}{\cos\left( 2\pi ft \right)} = \color{blue}{\frac{1}{2}e^{i2\pi ft}} + \color{red}{\frac{1}{2}e^{- i2\pi ft}}$</p>

<p>Think of $\cos\left( 2\pi ft \right)$ as a point moving on the complex plane.</p>

<div style="float;"><img src=".//media/fourier/image2.jpeg" width="250px"></div>
<div style="float;"><img src=".//media/fourier/image1.gif" width="250px"></div>
<div style="float;"><img src=".//media/fourier/image2.gif" width="250px"></div>
<p>click on image to see more interesting examples</p>
<div style="float;"><a href="https://www.youtube.com/watch?v=r6sGWTCMz2k"><img src=".//media/fourier/image3.jpeg" width="250px"></a></div>

<p>If the coefficient of $e^{i\omega t}$ and $e^{- i\omega t}$ are the same, the signal is real</p>

<p>$\color{blue}{1e^{i2\pi 0.5t}} + \color{red}{1e^{- i2\pi 0.5t}} + \color{orange}{\frac{1}{2}e^{- i2\pi 1t}}$</p>
<div style="float;"><img src=".//media/fourier/image3.gif" width="250px"></div>
<div style="float;"><img src=".//media/fourier/image4.jpeg" width="250px"></div>

<p>$\color{blue}{1e^{i2\pi 0.5t}} + \color{red}{1e^{- i2\pi 0.5t}} + \color{purple}{\frac12e^{i2\pi1t}} + \color{orange}{\frac{1}{2}e^{- i2\pi 1t}}$</p>
<div style="float;"><img src=".//media/fourier/image4.gif" width="250px"></div>
<div style="float;"><img src=".//media/fourier/image5.jpeg" width="250px"></div>

<p>In addition to multiplying by nonnegative constants, we can change their starting angle by multiplying by terms of the form $e^{i\phi}$.
<!-- more images to come --></p>

<h3 id="fourier-transform">Fourier transform</h3>

<p>But most functions are not periodic</p>

<p>Even the ones we talked about as periodic are bounded in time (do not repeat forever)</p>

<p>Instead of writing the frequency content as a sum, we write it as an integral</p>

<p>$x(t) = \int_{- \infty}^{\infty}{X\left( f \right)}e^{i2\pi ft}df$</p>

<p>Here, $X\left( f \right)$ determines “how much” of frequency $f$ is in signal $x(t)$</p>

<p>How do we find it? With this integral (we won’t be computing these integrals)</p>

<p>$X\left( f \right) = \int_{- \infty}^{\infty}{x\left( t \right)}e^{- i2\pi ft}dt$</p>

<p>Finding $X(f)$ for a given $f$</p>

<p>Multiplying by $e^{- i2\pi ft}$ winds the signal around the origin in the complex plane. Each $1/f$ time units becomes one clockwise round around the origin.</p>

<p>The integral takes finds the average of the resulting curve.</p>

<p>The result is generally a complex number; we focus on $\vert X\left( f \right) \vert$</p>

<p>The Fourier transform of
$1 + \sin\left( 2\pi 6t \right),0 \leq t \leq 1$ at $f = 0$ Hz</p>

<div style="float;"><img src=".//media/fourier/image14.png" width="800px"></div>
<!-- hard to transfer annotation -->
<!-- more matlab demo  -->

<div class="highlight">
<strong>Fundamental Tenet VIII:</strong>
<p>There is a one-to-one relationship between a signal and its frequency domain representation.</p>
</div>

<p>Stated differently: Every signal (video, audio, picture, etc.) has a frequency domain representation that is unique and contains all the information of the original signal. The way one computes the frequency domain representation from a given signal is called the Fourier transform.</p>

<p>We won’t worry about analytically computing Fourier transforms in this class – we’ll save that treat for ECE Fundamentals III ☺
Instead, we will focus on some important properties and let software like MATLAB plot spectra for us.
Analytical equations are generally unavailable for real-world signals, anyway…</p>

<p>Important properties:</p>
<ul>
  <li>Linearity</li>
  <li>Scaling time and frequency</li>
  <li>Symmetry</li>
  <li>Later: Multiplication by sinusoids, frequency response</li>
</ul>

<p>Piano vs Trumpet, again
<!-- transfer sound -->
Linearity
<!-- matlab --></p>

<p>One observation from the previous examples:  adding an A and a C# did not produce any “new” frequencies, just A, C# and harmonics. This is a consequence of the linearity. This property allows us to predict the spectrum of a combination of signals (e.g., a chord) from the spectra of the individual signals (e.g., pure tones).
It can be divided into two elementary properties:
Superposition: If x(t) has spectrum X(f), and y(t) has spectrum Y(f), then the sum x(t) + y(t) has the spectrum X(f) + Y(f).
Scaling: If x(t) has spectrum X(f), and a is a constant, then, ax(t) has spectrum aX(f).
Putting these together proves linearity:
If x(t) has spectrum X(f), y(t) has spectrum Y(f), and a and b are both fixed, then ax(t) + by(t) has spectrum aX(f) + bY(f).</p>

<p>A more complex spectrum (just for fun)
<!-- more fun sound needed --></p>

<p>Scaling time and frequency
<!-- fun sound --></p>

<p>The peak at 900 Hz is at 1800Hz if we double the speed
If $X(f)$ is the spectrum of $x(t)$, then the spectrum of $x(at)$ is $X(\frac{f}a)$
Faster in time ($a&gt;1$, graph shrinks) means higher frequencies (graph exapands)
Conclusion: changing the speed of a musical recording changes pitch. To change speed without altering pitch is not straightforward!</p>

<p>*voice spinner in chrome music lab</p>

<p>High and low More examples
Although complicated, there are distinct peaks.
Can we determine the key from the spectrum?
Major triad: B♭, D, F (B♭ is $440 \times 2^{1/12}$), Other peaks:  notes in Bb major scale (C, E♭, G, A)</p>

<p>Another real-world spectrum
Hallelujah chorus:</p>

<p>What do you notice about the predominant frequencies?
Are all these frequencies being played at once?</p>

<p>Quantization error in the frequency domain</p>

<p>Symmetry</p>

<p>In general, given a complex-valued signal x(t), the spectrum X(f) has no guaranteed symmetry, and we need to look at both the positive and negative frequency axes to completely describe the signal.
However, for a real-valued signal, the spectrum X(f) will have a special complex-valued symmetry called conjugate, or Hermitian, symmetry:</p>
<ul>
  <li>The real component of the spectrum will have even symmetry:
$X_R(f) = X_R(-f)$</li>
  <li>The imaginary component of the spectrum will have odd symmetry:
$X_I(f) = -X_I(-f)$</li>
  <li>The magnitude of the spectrum will have even symmetry:
$\vert X(f) \vert = \vert X(-f)\vert$</li>
  <li>The phase of the spectrum will have odd symmetry:
$\angle X (f) = -\angle X(-f)$</li>
</ul>

<p>Pure tones and frequency “spikes”
Given a pure tone x(t) = cos(2πft), the frequency representation X(f) consists of a discontinuous spike at exactly ±f. 
More formally we call this spike a Dirac delta function δ(f-f0), centered at frequency f0. It has infinite height at frequency f0, and is zero at all other frequencies.
Aside: In a strict mathematical sense, this function is undefined at  f0. Instead, we define it implicitly, via the integral equationwhere X(f) is some real-valued function. Actually, even this definition is not strictly correct, but it’s close enough. The proper definition would require a graduate course in mathematical analysis.
Setting X(f) = 1, we observe that the delta function has unit area.</p>

<h3 id="pure-tones-and-frequency-spikes">Pure tones and frequency spikes</h3>
<p>Note, we haven’t said anything about amplitude or phase here. This is because the spike’s location depends only on the sinusoid’s frequency. 
The amplitude A and phase φ will appear as a complex number Aeiφ multiplying the positive frequency (f0) spike and Ae-iφ multiplying the negative (-f0) spike.</p>

<p>In our plots before, we saw sinusoids that were limited in time. Their spectrum was similar to above, but not really a Dirac delta (we can’t really plot that with MATLAB)</p>

<h3 id="some-fourier-transform-examples">Some Fourier transform examples</h3>
<h3 id="frequency-vs-time-the-spectrogram">Frequency vs. time: the spectrogram</h3>
<p>As we observed earlier, different sounds produce different frequency content.
Music blends and varies different arrangements of these sounds through time. 
The Fourier spectrum provides a global picture of frequency content, it reflects all the frequencies present in the music. 
A more useful characterization of music would provide a local picture of frequency content as it varies through time.
The spectrogram is one such characterization.</p>

<ul>
  <li>spectrogram in chrome music lab</li>
</ul>

<p>The spectrogram
The spectrogram visualizes what we call the short-time Fourier transform.
Normally, a single Fourier transform is computed for an entire signal.
The short-time Fourier transform divides the signal into small, overlapping time intervals and computes a spectrum for each one separately.
These spectra are plotted on a two-dimensional graph, with the frequency content along one axis, and the time dimension along the other.
This 2D plot allows us to measure how the relative weighting of different frequency content changes through time.
The spectrogram is one form of what is more generally called time-frequency analysis. Such methods allow engineers to design systems that analyze complicated signals in useful ways.
Tools like Shazam form musical fingerprints from spectrograms to help identify music.
Medical devices use time-frequency analysis to analyze heart rhythm.</p>


<footer>
  <br><br>
  <center>
    <hr>
  © Farzad Farnoud, 2023</center>
</footer>
</div>
<!-- Default Statcounter code for MoI
http://www.ece.virginia.edu/~ffh8x/moi/ -->
<script type="text/javascript">
var sc_project=12471818; 
var sc_invisible=1; 
var sc_security="62b9c6a1"; 
</script>
<script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/12471818/0/62b9c6a1/1/" alt="Web Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->
</body>
</html>
